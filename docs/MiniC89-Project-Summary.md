# MiniC89 프로젝트 진행 정리 (v0.53)
본 문서는 사이버보안학과 신입생 교육을 목적으로 하는
**C89 문법을 사용하는 안전한 교육용 언어 MiniC89**와 교육 플랫폼(컴파일러, 추상머신, 온라인 저지)의 개요다.

## 1. 프로젝트 목표
- C 언어를 **처음 접하는 신입생**을 대상으로 한다.
- C89 표준 중 `int`, `for`, `if`, 함수에 해당하는 내용만 추려서 구성한다.
- C89 표준 중 최신 트렌드에서 많이 벗어난 일부 문법/제약은 최신 C 규칙을 채택한다. 
- 실행 환경은 모든 Undefined Behavior를 검출해서 진단한다. 
- 실행 환경은 실행 과정을 브라우저에서 시각적으로 보여준다.
- 실행 환경은 아주 세분화된 난이도 별로 함수 단위 문제 풀이 플랫폼을 제공한다. 

## 2. 언어 개요 (C89와 비교하여)

### 2.1 기본 철학
- MiniC89는 C89을 기반으로 하되 일부 문법/제약은 최신 C 규칙을 채택한다.
- C에서 위험한 것은 MiniC89에서는 오류로 진단한다.

### 2.2 타입 시스템
- MiniC89에는 **오직 `int` 타입만 존재**한다.
- `int`는 **정확히 16-bit, 2의 보수 표현**이다.
- `int`의 범위는 -32768부터 32767까지다.
- 정수 리터럴은 `0`부터 `32767`만 허용한다.

### 2.3 연산자
- `int`에 대한 산술 연산, 단순 대입 연산, 비교 연산, 논리 연산만 가능하다.
- 산술 연산은 수학적 정수로 계산한다.
  - 불가능한 연산이거나 산술 연산 결과가 표현 범위를 벗어나면 UB로 진단한다.
  - 컴파일 타임 상수식에서는 UB 대신 컴파일 에러를 발생시킨다.
- 음수 `/`는 0을 향해 절단한다. (C99+ 준수)
- 음수 `%`는 `a == (a / b) * b + a % b`를 만족해야 한다. (C99+ 준수)
- `&&`, `||`는  왼쪽부터 평가되며, 왼쪽 항 평가 후 시퀀스 포인트가 존재하고, 쇼트서킷한다. 
- 구현체는 시퀀스 포인트 규칙 위반을 컴파일 에러로 진단한다.
  - C89 시퀀스 포인트 규칙을 따른다.
- 선언되지 않은 함수의 호출은 금지한다. (C99+ 준수)

### 2.4 문장
- 복합문, 식문, `if`문, `for`문, `continue`문, `break`문, `return`문, null 문만 허용된다.

### 2.5 선언
- 변수는 가장 기본적인 지역 변수만 허용된다.
- 변수 선언 위치는 문장 다음에 나와도 된다. (C99+ 준수)
- `for`문 안에서도 변수 선언을 할 수 있다. (C99+ 준수)
- 함수 선언은 프로토타입만 허용한다. (C23 준수)
  - `int f()`는 매개변수 없음으로 정의한다. (구버전 C와 다름)

### 2.6 구현체
- 프리스탠딩 구현체만 허용한다.
- 한 step은 바이트코드 1개를 의미한다. 
- 구현체에서는 무한 루프 방지용 step 제한을 둔다.
  - 초과시 결과 코드 `Time Limit Exceeded`
- 구현체에서는 무한 재귀 방지용 콜스택 제한을 둔다. 
  - 초과시 결과 코드 `Stack Overflow`
- 구현체 런타임에서 UB를 진단한다
  -  발생시 결과 코드 `Runtime Error (Undefined Behavior detected)`

### 2.7 라이브러리
- 라이브러리는 제공하지 않는다.
- 어떤 내장 함수도 제공하지 않는다.

### 2.8 허용되는 문법 요소
- 타입: `int`
- 연산: `+`, `-`, `*`, `/`, `%`, `=`, `==`, `!=`, `<`, `<=`, `>`, `>=`, `&&`, `||`, `!`, 함수 호출, 괄호, 변수 접근
- 문장: `if`, `else`, `for`, `break`, `continue`, `return`
- 함수 정의
- 함수 프로토타입 선언
- 정수 상수
- 변수 및 매개변수 선언에서의 `,`

### 2.9 금지되는 문법 요소
- 문자 상수, 실수 상수, 문자열 리터럴
- 타입: `char`, `float`, `double`, `short`, `long`, `unsigned`, `signed`, 배열, 포인터, `struct`, `union`, `enum`, `typedef`
- 연산: `[]`, `.`, `->`, `++`, `--`, `&`, `sizeof`, `(type)`, `<<`, `>>`, `|`, `~`, `? :`, `+=`, `-=`, `*=`, `/=`, `%=`, `&=`, `|=`, `<<=`, `>>=`, `,`
- 라벨문, `switch`, `while`, `do`, `goto`
- 전처리기 지시문
- 전역 변수, 비프로토타입(옛 스타일) 함수 선언
- `auto`, `static`, `register`, `extern`, `const`, `volatile`

### 2.10 Undefined Behavior 목록
- `0`으로 나눔 및 나머지
- `int` 범위 초과
- 미초기화 지역 변수 읽기
- `int` 함수가 `return` 없이 종료

## 3. 구현체
- 실행은 추상 머신 위에서 이루어진다
- 실행 과정은 브라우저 환경에서 단계적으로 시각화된다

### 3.1 관찰 가능한 상태
- 프로그램 카운터
- 함수 호출 스택
- 현재 스택 프레임의 지역 변수
- 수식 평가 결과
- 조건문의 제어 흐름
- 반복문의 제어 흐름

### 3.2 구현 언어
- 컴파일러, 가상 머신, 정적 분석 도구는 모두 C 언어로 구현

### 3.3 웹 실행
- C로 구현된 컴파일러/VM을 WASM으로 컴파일
- 브라우저에서 실행 및 시각화 제공

## 4. 온라인 저지
### 4.0 문제 형식
- 문제마다 제출해야 할 함수 시그니처를 제공하고, 채점기는 여러 테스트에 대해 호출한 뒤 반환값을 비교한다.

### 4.1 문제 종류
- 수식 문제
- `if` 문제
- `for` 문제

### 4.2 문제 난이도
- 아주 쉬움
- 쉬움
- 조금 쉬움
- 조금 어려움
- 어려움
- 아주 어려움
- 6단계를 세분화해서 난이도를 만든다.

## 5. 문서화
- 언어 표준: C89 Draft의 목차 및 내용에서 MiniC89에 해당하는 내용을 차용한다. 
  - Lexical Elements (어휘): 식별자, 키워드, 정수 상수, 연산자.
  - Types (타입): `int` 단일 타입 정의.
  - Expressions (수식): 연산자 우선순위, 평가 순서, 시퀀스 포인트 규칙, 허용된 연산자 목록.
  - Statements (문장): 제어문의 의미
  - Undefined Behaviors (정의되지 않은 동작): 구현체가 반드시 잡아내는 에러 목록.
- 추상 머신 명세
  - Memory Model: 스택 프레임 구조, 변수 저장 방식.
  - Execution Limit: Step(바이트코드 단위) 제한, Call Stack 깊이 제한 정책.
  - Visualizer Mapping: 소스 코드 라인과 바이트코드 간의 매핑 규칙.
- 온라인 저지 정책
  - Input/Output: 표준 입출력이 없는 대신, 함수 인자와 리턴값으로 채점.
  - Validation: Stack Overflow나 Time Limit 발생시 오답 처리 규정.
